function registerServiceWorker(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(e){}).catch(function(e){console.log("ServiceWorker registration failed!")})})}registerServiceWorker(),"indexedDB"in window||console.log("This browser doesn't support IndexedDB");var dbPromise=idb.open("restaurantsAppDB",2,function(e){(console.log("making a new object store"),e.objectStoreNames.contains("restaurants")||e.createObjectStore("restaurants",{keyPath:"id"}),e.objectStoreNames.contains("reviews"))||e.createObjectStore("reviews",{keyPath:"id"}).createIndex("restaurant_id","restaurant_id");e.objectStoreNames.contains("reviewsOff")||e.createObjectStore("reviewsOffline",{keyPath:"updatedAt"})});dbPromise.then(e=>{DBHelper.fetchRestaurantsFromServer((r,t)=>{t.forEach(function(r){e.transaction("restaurants","readwrite").objectStore("restaurants").put(r)})})}),dbPromise.then(e=>{DBHelper.fetchReviewsFromServer((r,t)=>{t.forEach(function(r){e.transaction("reviews","readwrite").objectStore("reviews").put(r)})})});